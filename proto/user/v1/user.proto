syntax = "proto3";

package proto.user.v1;


// The UserService handles identity-related actions for internal service communication.
service UserService {
  // Updates the current plan associated with a user.
  //
  // Typically called by the PlanService when a user subscribes to,
  // upgrades, or cancels a plan.
  rpc UpdateUserPlan(UpdateUserPlanRequest) returns (UpdateUserPlanResponse);
  rpc GetUserDetailsFromSession(GetUserDetailsFromSessionRequest) returns (GetUserDetailsFromSessionResponse);
  rpc GetUserSettings(GetUserSettingsRequest) returns (GetUserSettingsResponse);

}


// Request message for updating a user's plan.
message UpdateUserPlanRequest {

  string auth0_id = 1;   // Auth0 user ID fallback

  // The ID of the new plan the user is being associated with.
  string plan_id = 2;

  // The timestamp when the update was initiated or processed.
  string updated_at = 3;
}


// Response message for the UpdateUserPlan RPC.
message UpdateUserPlanResponse {
  // Whether the update was successful.
  bool success = 1;

  // Optional error message if the update failed.
  optional string error_message = 2;

  // Optional error code (e.g. 404 for not found, 500 for internal error).
  int32 code = 3;
}

message GetUserDetailsFromSessionRequest {
  string session_id = 1;
}

message GetUserDetailsFromSessionResponse {
  bool success = 1;

  optional string auth0_id = 2;

  optional string role = 3;

  repeated string permissions = 4;

  optional string error_message = 5;

  int32 code = 6;

  

}

message GetUserSettingsRequest {
  string auth0_id = 1;
}

message GetUserSettingsResponse {
  bool success = 1;
  
  map<string, string> settings = 2;
  optional string error_message = 3;
  int32 code = 4;
  

}